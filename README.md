# AI-XMPP-Bot

XMPP-бот с интеграцией ИИ для автоматизированного общения в групповых чатах. Бот анализирует сообщения, генерирует ответы на русском языке и поддерживает безопасное шифрование.

## Особенности

- **XMPP интеграция**: Подключение к XMPP серверам и MUC комнатам
- **ИИ ответы**: Использование Ollama моделей для генерации контекстных ответов
- **OMEMO шифрование**: Защищенное шифрование сообщений
- **Анализ контекста**: Автоматическое принятие решения об ответе на основе темы и настроения беседы
- **Эффекты печати**: Имитация набора текста для более естественного общения
- **Детекция кода**: Специализированная обработка вопросов о программировании

## Быстрый старт

### Требования

- Python 3.12 или выше
- Установленный и запущенный Ollama сервер (http://localhost:11434). Подробнее по [ссылке](https://ollama.com/)

### Установка

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/yurokbrat/ai-xmpp-bot
   cd ai-xmpp-bot
   ```

2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```

3. Настройте переменные окружения:
   ```bash
   cp .env.example .env
   # Отредактируйте .env файл с вашими настройками
   ```

### Запуск

```bash
python main.py
```

## Конфигурация

Основные переменные окружения в `.env`:

- `BOT_JID` - JID бота (например, bot@example.com)
- `BOT_PASSWORD` - Пароль бота
- `BOT_NICK` - Никнейм бота в комнате
- `ADMIN_JID` - JID администратора для уведомлений
- `MUC_ROOM` - JID MUC комнаты (например, room@conference.example.com)
- `AI_DEFAULT_MODEL` - Модель Ollama для общего чата (по умолчанию: qwen2.5:3b-instruct)
- `AI_CODE_MODEL` - Модель Ollama для вопросов о коде (по умолчанию: deepseek-coder:1.3b)
- `OLLAMA_URL` - URL сервера Ollama (по умолчанию: http://localhost:11434)
- `IS_DEBUG` - Режим отладки (true/false, по умолчанию: false)
- `LOGGING_LEVEL` - Уровень логирования (DEBUG/INFO/WARNING/ERROR, по умолчанию: INFO)
- `ENABLE_TYPING_EFFECT` - Включить эффект печати (true/false, по умолчанию: true)

## Использование

После запуска бот автоматически:
1. Подключается к XMPP серверу
2. Присоединяется к указанной MUC комнате
3. Слушает сообщения и анализирует их
4. Генерирует ответы на основе контекста беседы

Бот отвечает только когда:
- Его напрямую обращаются ("бот", "AI", "ИИ")
- Задают вопросы
- Просьбы о помощи
- Споры или конфликты
- Длительные паузы в беседе

## Разработка

Проект использует:
- **slixmpp** для XMPP протокола
- **langchain** для работы с LLM
- **pydantic** для настроек
- **asyncio** для асинхронной работы

Структура проекта:
- `src/bot.py` - основная логика бота
- `src/mixins.py` - миксины для расширения функциональности бота
- `src/services/` - сервисы для бота
- `src/custom_omemo/` - реализация OMEMO шифрования
